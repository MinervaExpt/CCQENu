\hypertarget{_sep18_2_variable_from_config_8h_source}{}\doxysection{Variable\+From\+Config.\+h}
\label{_sep18_2_variable_from_config_8h_source}\index{make\_hists/include/Sep18/VariableFromConfig.h@{make\_hists/include/Sep18/VariableFromConfig.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef VARIABLEFromConfig\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define VARIABLEFromConfig\_H}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include "{}CVUniverse.h"{}}}
\DoxyCodeLine{5 \textcolor{comment}{//\#include "{}PlotUtils/HistFolio.h"{}  -\/ gives annoying error messages}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include "{}HistWrapperMap.h"{}}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include "{}MinervaUnfold/MnvResponse.h"{}}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include "{}utils/NuConfig.h"{}}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include "{}include/CVFunctions.h"{}}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#ifndef \_\_CINT\_\_  }\textcolor{comment}{// CINT doesn't know about std::function}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include "{}PlotUtils/VariableBase.h"{}}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// \_\_CINT\_\_}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{keyword}{namespace }CCQENu \{}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 }
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{keyword}{class }\mbox{\hyperlink{class_c_c_q_e_nu_1_1_variable_from_config}{VariableFromConfig}} : \textcolor{keyword}{public} PlotUtils::VariableBase<CVUniverse> \{}
\DoxyCodeLine{22 \textcolor{keyword}{private}:}
\DoxyCodeLine{23   \textcolor{keyword}{typedef} std::function<double(\textcolor{keyword}{const} \mbox{\hyperlink{class_c_v_universe}{CVUniverse}}\&)> PointerToCVUniverseFunction;}
\DoxyCodeLine{24   \textcolor{keyword}{typedef} \mbox{\hyperlink{class_plot_utils_1_1_hist_wrapper_map}{PlotUtils::HistWrapperMap<CVUniverse>}} \mbox{\hyperlink{class_plot_utils_1_1_hist_wrapper_map}{HM}};}
\DoxyCodeLine{25   \textcolor{keyword}{typedef} PlotUtils::MnvH1D MH1D;}
\DoxyCodeLine{26   \textcolor{comment}{//  typedef PlotUtils::HistFolio<PlotUtils::MnvH1D> FOLIO;}}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{keyword}{public}:}
\DoxyCodeLine{30   \textcolor{comment}{//=======================================================================================}}
\DoxyCodeLine{31   \textcolor{comment}{// CTOR}}
\DoxyCodeLine{32   \textcolor{comment}{//=======================================================================================}}
\DoxyCodeLine{33   \textcolor{comment}{//template <class... ARGS>}}
\DoxyCodeLine{34   \textcolor{comment}{//VariableFromConfig(ARGS... args) : PlotUtils::VariableBase<CVUniverse>(args...) \{\}}}
\DoxyCodeLine{35 }
\DoxyCodeLine{36   \textcolor{comment}{// HMS 2-\/13-\/202 replace the templated constructor with explicit ones so we can make a config version without introducing a dependency in the Base class.}}
\DoxyCodeLine{37 }
\DoxyCodeLine{38 }
\DoxyCodeLine{39 }
\DoxyCodeLine{40   \mbox{\hyperlink{class_c_c_q_e_nu_1_1_variable_from_config}{VariableFromConfig}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_nu_config}{NuConfig}} config)\{}
\DoxyCodeLine{41     \textcolor{comment}{//config.Print();}}
\DoxyCodeLine{42 }
\DoxyCodeLine{43     \mbox{\hyperlink{class_c_v_functions}{CVFunctions<CVUniverse>}} fun;}
\DoxyCodeLine{44     \textcolor{comment}{//fun.InitFunctionMaps();}}
\DoxyCodeLine{45     std::string recovar = config.GetString(\textcolor{stringliteral}{"{}reco"{}});}
\DoxyCodeLine{46     \textcolor{keywordtype}{bool} good = \textcolor{keyword}{false};}
\DoxyCodeLine{47     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} key:fun.GetRecoKeys())\{}
\DoxyCodeLine{48 }
\DoxyCodeLine{49       \textcolor{keywordflow}{if} (recovar == key)\{}
\DoxyCodeLine{50         std::cout << \textcolor{stringliteral}{"{} reco function keys "{}} << key <<  std::endl;}
\DoxyCodeLine{51         good = \textcolor{keyword}{true};}
\DoxyCodeLine{52         \textcolor{keywordflow}{break};}
\DoxyCodeLine{53       \}}
\DoxyCodeLine{54     \}}
\DoxyCodeLine{55 }
\DoxyCodeLine{56     \textcolor{keywordflow}{if} (!good)\{}
\DoxyCodeLine{57       std::cout << \textcolor{stringliteral}{"{}VariableFromConfig(config) is asking for an unimplemented reco variable "{}} << recovar << std::endl;}
\DoxyCodeLine{58       exit(1);}
\DoxyCodeLine{59     \}}
\DoxyCodeLine{60     \textcolor{keywordtype}{bool} tgood = \textcolor{keyword}{false};}
\DoxyCodeLine{61     std::string truevar = config.GetString(\textcolor{stringliteral}{"{}true"{}});}
\DoxyCodeLine{62     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} key:fun.GetTrueKeys())\{}
\DoxyCodeLine{63 }
\DoxyCodeLine{64       \textcolor{keywordflow}{if} (truevar == key)\{}
\DoxyCodeLine{65         std::cout << \textcolor{stringliteral}{"{} true function keys "{}} << key <<  std::endl;}
\DoxyCodeLine{66         tgood = \textcolor{keyword}{true};}
\DoxyCodeLine{67         \textcolor{keywordflow}{break};}
\DoxyCodeLine{68       \}}
\DoxyCodeLine{69     \}}
\DoxyCodeLine{70 }
\DoxyCodeLine{71     \textcolor{keywordflow}{if} (!tgood)\{}
\DoxyCodeLine{72       std::cout << \textcolor{stringliteral}{"{}VariableFromConfig(config) is asking for an unimplemented true variable "{}} << truevar << std::endl;}
\DoxyCodeLine{73       exit(1);}
\DoxyCodeLine{74     \}}
\DoxyCodeLine{75 }
\DoxyCodeLine{76     PlotUtils::VariableBase<CVUniverse>::m\_pointer\_to\_GetRecoValue = (fun.GetRecoFunction(recovar));}
\DoxyCodeLine{77     PlotUtils::VariableBase<CVUniverse>::m\_pointer\_to\_GetTrueValue = (fun.GetTrueFunction(truevar));}
\DoxyCodeLine{78 }
\DoxyCodeLine{79     PlotUtils::VariableBase<CVUniverse>::m\_name = config.GetString(\textcolor{stringliteral}{"{}name"{}});}
\DoxyCodeLine{80     PlotUtils::VariableBase<CVUniverse>::m\_xaxis\_label = config.GetString(\textcolor{stringliteral}{"{}title"{}});}
\DoxyCodeLine{81 }
\DoxyCodeLine{82     \textcolor{keywordflow}{if} (config.IsMember(\textcolor{stringliteral}{"{}for"{}}))\{}
\DoxyCodeLine{83       m\_for = config.GetStringVector(\textcolor{stringliteral}{"{}for"{}});}
\DoxyCodeLine{84     \}}
\DoxyCodeLine{85     \textcolor{keywordflow}{else}\{ \textcolor{comment}{// turn them all on for now}}
\DoxyCodeLine{86        std::vector<std::string> def = \{\textcolor{stringliteral}{"{}data"{}},\textcolor{stringliteral}{"{}selected\_reco"{}},\textcolor{stringliteral}{"{}selected\_truth"{}},\textcolor{stringliteral}{"{}response"{}},\textcolor{stringliteral}{"{}truth"{}}\};}
\DoxyCodeLine{87       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} s:def)\{}
\DoxyCodeLine{88         m\_for.push\_back(s);}
\DoxyCodeLine{89       \}}
\DoxyCodeLine{90     \}}
\DoxyCodeLine{91 }
\DoxyCodeLine{92     \textcolor{comment}{// Control at variable level whether to run tuned mc or not}}
\DoxyCodeLine{93     \textcolor{keywordflow}{if} (config.IsMember(\textcolor{stringliteral}{"{}tunedmc"{}}))\{}
\DoxyCodeLine{94       std::string checkval = config.GetString(\textcolor{stringliteral}{"{}tunedmc"{}});}
\DoxyCodeLine{95       \textcolor{comment}{// "{}both"{} or 2 runs both tuned and untuned mc}}
\DoxyCodeLine{96       \textcolor{keywordflow}{if}(checkval==\textcolor{stringliteral}{"{}both"{}} || checkval==\textcolor{stringliteral}{"{}2"{}})\{}
\DoxyCodeLine{97         std::cout << \textcolor{stringliteral}{"{}VariableFromConfig(config) set up both tuned and untuned MC."{}} << std::endl;}
\DoxyCodeLine{98         m\_tunedmc = 2;}
\DoxyCodeLine{99       \}}
\DoxyCodeLine{100       \textcolor{comment}{// "{}only"{} or 1 runs only tuned mc (not untuned)}}
\DoxyCodeLine{101       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(checkval==\textcolor{stringliteral}{"{}only"{}} || checkval==\textcolor{stringliteral}{"{}1"{}})\{}
\DoxyCodeLine{102         std::cout << \textcolor{stringliteral}{"{}VariableFromConfig(config) set up only tuned MC."{}} << std::endl;}
\DoxyCodeLine{103         m\_tunedmc = 1;}
\DoxyCodeLine{104       \}}
\DoxyCodeLine{105       \textcolor{comment}{// "{}none"{} or 0 runs only untunedmc}}
\DoxyCodeLine{106       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(checkval==\textcolor{stringliteral}{"{}none"{}} || checkval==\textcolor{stringliteral}{"{}0"{}})\{}
\DoxyCodeLine{107         std::cout << \textcolor{stringliteral}{"{}VariableFromConfig(config) set up only untuned MC."{}} << std::endl;}
\DoxyCodeLine{108         m\_tunedmc = 0;}
\DoxyCodeLine{109       \}}
\DoxyCodeLine{110       \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{111         std::cout << \textcolor{stringliteral}{"{}VariableFromConfig Warning: invalid 'tunedmc' configured. Defaulting to running both tuned and untuned MC. "{}} << std::endl;}
\DoxyCodeLine{112         m\_tunedmc = 2;}
\DoxyCodeLine{113       \}}
\DoxyCodeLine{114     \}}
\DoxyCodeLine{115     \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{116       \textcolor{comment}{// Default to running both tuned and untuned}}
\DoxyCodeLine{117       std::cout << \textcolor{stringliteral}{"{}VariableFromConfig: 'tunedmc' not configured. Defaulting to running both tuned and untuned MC. "{}} << std::endl;}
\DoxyCodeLine{118       m\_tunedmc = 2;}
\DoxyCodeLine{119     \}}
\DoxyCodeLine{120 }
\DoxyCodeLine{121     \textcolor{keywordflow}{if} (config.IsMember(\textcolor{stringliteral}{"{}bins"{}}))\{}
\DoxyCodeLine{122       PlotUtils::VariableBase<CVUniverse>::m\_binning =  config.GetDoubleVector(\textcolor{stringliteral}{"{}bins"{}});}
\DoxyCodeLine{123       \textcolor{keywordflow}{if} (config.IsMember(\textcolor{stringliteral}{"{}recobins"{}}))\{}
\DoxyCodeLine{124           PlotUtils::VariableBase<CVUniverse>::m\_reco\_binning = config.GetDoubleVector(\textcolor{stringliteral}{"{}recobins"{}});}
\DoxyCodeLine{125           PlotUtils::VariableBase<CVUniverse>::m\_has\_reco\_binning = \textcolor{keyword}{true};}
\DoxyCodeLine{126       \}}
\DoxyCodeLine{127       \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{128           PlotUtils::VariableBase<CVUniverse>::m\_has\_reco\_binning = \textcolor{keyword}{false};}
\DoxyCodeLine{129       \}}
\DoxyCodeLine{130     \}}
\DoxyCodeLine{131     \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{132       \textcolor{keywordtype}{int} nbins = config.GetInt(\textcolor{stringliteral}{"{}nbins"{}});}
\DoxyCodeLine{133       \textcolor{keywordtype}{double} xmin = config.GetDouble(\textcolor{stringliteral}{"{}min"{}});}
\DoxyCodeLine{134       \textcolor{keywordtype}{double} xmax = config.GetDouble(\textcolor{stringliteral}{"{}max"{}});}
\DoxyCodeLine{135       PlotUtils::VariableBase<CVUniverse>::m\_binning =  MakeUniformBinning(nbins,xmin,xmax);}
\DoxyCodeLine{136       \textcolor{keywordflow}{if} (config.IsMember(\textcolor{stringliteral}{"{}nrecobins"{}}))\{}
\DoxyCodeLine{137           \textcolor{keywordtype}{int} nrecobins = config.GetInt(\textcolor{stringliteral}{"{}nrecobins"{}});}
\DoxyCodeLine{138           \textcolor{keywordtype}{double} xrecomin = config.GetDouble(\textcolor{stringliteral}{"{}recomin"{}});}
\DoxyCodeLine{139           \textcolor{keywordtype}{double} xrecomax = config.GetDouble(\textcolor{stringliteral}{"{}recomax"{}});}
\DoxyCodeLine{140           PlotUtils::VariableBase<CVUniverse>::m\_reco\_binning =  MakeUniformBinning(nrecobins,xrecomin,xrecomax);}
\DoxyCodeLine{141       \}}
\DoxyCodeLine{142       \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{143           PlotUtils::VariableBase<CVUniverse>::m\_has\_reco\_binning = \textcolor{keyword}{false};}
\DoxyCodeLine{144       \}}
\DoxyCodeLine{145     \}}
\DoxyCodeLine{146       std::cout << \textcolor{stringliteral}{"{} Check Binning For"{}} << config.GetString(\textcolor{stringliteral}{"{}name"{}}) << std::endl;}
\DoxyCodeLine{147       PrintBinning();}
\DoxyCodeLine{148       PrintRecoBinning();}
\DoxyCodeLine{149   \}}
\DoxyCodeLine{150 }
\DoxyCodeLine{151   \textcolor{keyword}{typedef} std::map<std::string, std::vector<CVUniverse*>> UniverseMap;}
\DoxyCodeLine{152   \textcolor{comment}{//=======================================================================================}}
\DoxyCodeLine{153   \textcolor{comment}{// DECLARE NEW HISTOGRAMS}}
\DoxyCodeLine{154   \textcolor{comment}{//=======================================================================================}}
\DoxyCodeLine{155   \textcolor{comment}{// Histwrappers -\/-\/ selected mc, selected data}}
\DoxyCodeLine{156 }
\DoxyCodeLine{157   \mbox{\hyperlink{class_plot_utils_1_1_hist_wrapper_map}{HM}} m\_selected\_mc\_reco; \textcolor{comment}{// HM for normal MC hists -\/ has special constructor to make response}}
\DoxyCodeLine{158   \mbox{\hyperlink{class_plot_utils_1_1_hist_wrapper_map}{HM}} m\_tuned\_mc\_reco; \textcolor{comment}{// HM for tuned MC hists used for background subtraction -\/NHV -\/ has special constructor to make response}}
\DoxyCodeLine{159   \mbox{\hyperlink{class_plot_utils_1_1_hist_wrapper_map}{HM}} m\_selected\_mc\_truth;}
\DoxyCodeLine{160   \mbox{\hyperlink{class_plot_utils_1_1_hist_wrapper_map}{HM}} m\_tuned\_selected\_mc\_truth;}
\DoxyCodeLine{161   \mbox{\hyperlink{class_plot_utils_1_1_hist_wrapper_map}{HM}} m\_signal\_mc\_truth;}
\DoxyCodeLine{162   \mbox{\hyperlink{class_plot_utils_1_1_hist_wrapper_map}{HM}} m\_tuned\_signal\_mc\_truth;}
\DoxyCodeLine{163   \mbox{\hyperlink{class_plot_utils_1_1_hist_wrapper_map}{HM}} m\_selected\_data;}
\DoxyCodeLine{164   UniverseMap m\_universes;}
\DoxyCodeLine{165   std::string m\_units;}
\DoxyCodeLine{166   std::map<const std::string, bool> hasData;}
\DoxyCodeLine{167   std::map<const std::string, bool> hasMC;}
\DoxyCodeLine{168   std::map<const std::string, bool> hasSelectedTruth;}
\DoxyCodeLine{169   std::map<const std::string, bool> hasTruth;}
\DoxyCodeLine{170   std::map<const std::string, bool> hasResponse;}
\DoxyCodeLine{171   std::map<const std::string, bool> hasTunedMC;}
\DoxyCodeLine{172   std::vector<std::string> m\_tags;}
\DoxyCodeLine{173   std::vector<std::string> m\_for;}
\DoxyCodeLine{174   \textcolor{keywordtype}{int} m\_tunedmc;}
\DoxyCodeLine{175   \textcolor{comment}{//RESPONSE* m\_response;}}
\DoxyCodeLine{176   \textcolor{comment}{// helpers for response}}
\DoxyCodeLine{177 }
\DoxyCodeLine{178   \textcolor{comment}{// std::map< CVUniverse* , int> m\_map; // map to get name and index from Universe;}}
\DoxyCodeLine{179   \textcolor{comment}{// Histofolio to categorize MC by interaction channel}}
\DoxyCodeLine{180   \textcolor{comment}{//FOLIO m\_selected\_mc\_by\_channel;}}
\DoxyCodeLine{181   \textcolor{comment}{//FOLIO m\_selected\_mc\_truth\_by\_channel;}}
\DoxyCodeLine{182   \textcolor{keyword}{inline} \textcolor{keyword}{virtual} std::string GetUnits()\{\textcolor{keywordflow}{return} m\_units;\};}
\DoxyCodeLine{183 }
\DoxyCodeLine{184   \textcolor{keyword}{inline} \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} SetUnits(std::string units)\{m\_units=units;\};}
\DoxyCodeLine{185 }
\DoxyCodeLine{186   \textcolor{keyword}{inline} \textcolor{keyword}{virtual} \textcolor{keywordtype}{int} GetTuned()\{\textcolor{keywordflow}{return} m\_tunedmc;\};}
\DoxyCodeLine{187   \textcolor{comment}{//=======================================================================================}}
\DoxyCodeLine{188   \textcolor{comment}{// INITIALIZE ALL HISTOGRAMS}}
\DoxyCodeLine{189   \textcolor{comment}{//=======================================================================================}}
\DoxyCodeLine{190 }
\DoxyCodeLine{191 }
\DoxyCodeLine{192   \textcolor{keywordtype}{void} AddTags(\textcolor{keyword}{const} std::vector<std::string> tags)\{}
\DoxyCodeLine{193     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} t:tags)\{}
\DoxyCodeLine{194       m\_tags.push\_back(t);}
\DoxyCodeLine{195     \}}
\DoxyCodeLine{196   \};}
\DoxyCodeLine{197 }
\DoxyCodeLine{198   \textcolor{comment}{// all of the following could probably be the same code, sigh...}}
\DoxyCodeLine{199   \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{200   \textcolor{keywordtype}{void} InitializeMCHistograms(T univs, \textcolor{keyword}{const} std::vector< std::string> tags) \{}
\DoxyCodeLine{201     \textcolor{keywordflow}{if} (std::count(m\_for.begin(), m\_for.end(),\textcolor{stringliteral}{"{}selected\_reco"{}})< 1) \{}
\DoxyCodeLine{202       std::cout << \textcolor{stringliteral}{"{}VariableFromConfig Warning: selected\_reco is disabled for this variable "{}} << GetName() << std::endl;}
\DoxyCodeLine{203       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} tag:tags)\{}
\DoxyCodeLine{204         hasMC[tag] = \textcolor{keyword}{false};}
\DoxyCodeLine{205       \}}
\DoxyCodeLine{206       \textcolor{keywordflow}{return};}
\DoxyCodeLine{207     \}}
\DoxyCodeLine{208     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} tag:tags)\{}
\DoxyCodeLine{209       hasMC[tag] = \textcolor{keyword}{true};}
\DoxyCodeLine{210     \}}
\DoxyCodeLine{211 }
\DoxyCodeLine{212     \textcolor{keywordflow}{if}(m\_tunedmc==1)\{}
\DoxyCodeLine{213       std::cout << \textcolor{stringliteral}{"{}VariableFromConfig Warning: untuned MC disabled for this variable, only filling tuned MC "{}} << GetName() << std::endl;}
\DoxyCodeLine{214       \textcolor{keywordflow}{return};}
\DoxyCodeLine{215     \}}
\DoxyCodeLine{216 }
\DoxyCodeLine{217     std::vector<double> bins = GetBinVec();}
\DoxyCodeLine{218     std::vector<double> recobins = GetRecoBinVec();}
\DoxyCodeLine{219 \textcolor{comment}{// this one is special as we need to take into account a non-\/square response}}
\DoxyCodeLine{220     m\_selected\_mc\_reco = \mbox{\hyperlink{class_plot_utils_1_1_hist_wrapper_map}{HM}}(Form(\textcolor{stringliteral}{"{}\%s"{}}, GetName().c\_str()), (GetName()+\textcolor{stringliteral}{"{};"{}}+m\_xaxis\_label).c\_str(), GetNBins(), bins, GetNRecoBins(), recobins,  univs, tags);}
\DoxyCodeLine{221     m\_selected\_mc\_reco.AppendName(\textcolor{stringliteral}{"{}reconstructed"{}},tags); \textcolor{comment}{// patch to conform to CCQENU standard m\_selected\_mc\_truth.AppendName("{}\_truth"{},tags); // patch to conform to CCQENU standard}}
\DoxyCodeLine{222   \}}
\DoxyCodeLine{223 }
\DoxyCodeLine{224   \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{225   \textcolor{keywordtype}{void} InitializeSelectedTruthHistograms(T univs, \textcolor{keyword}{const} std::vector<std::string> tags) \{}
\DoxyCodeLine{226     \textcolor{keywordflow}{if} (std::count(m\_for.begin(), m\_for.end(),\textcolor{stringliteral}{"{}selected\_truth"{}})< 1) \{}
\DoxyCodeLine{227       std::cout << \textcolor{stringliteral}{"{}VariableFromConfig Warning: selected\_truth is disabled for this variable "{}} << GetName() << std::endl;}
\DoxyCodeLine{228       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} tag:tags)\{}
\DoxyCodeLine{229         hasSelectedTruth[tag] = \textcolor{keyword}{false};}
\DoxyCodeLine{230       \}}
\DoxyCodeLine{231       \textcolor{keywordflow}{return};}
\DoxyCodeLine{232     \}}
\DoxyCodeLine{233     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} tag:tags)\{}
\DoxyCodeLine{234       hasSelectedTruth[tag] = \textcolor{keyword}{true};}
\DoxyCodeLine{235     \}}
\DoxyCodeLine{236 }
\DoxyCodeLine{237     \textcolor{keywordflow}{if}(m\_tunedmc==1)\{}
\DoxyCodeLine{238       std::cout << \textcolor{stringliteral}{"{}VariableFromConfig Warning: untuned MC disabled for this variable, only filling tuned MC "{}} << GetName() << std::endl;}
\DoxyCodeLine{239       \textcolor{keywordflow}{return};}
\DoxyCodeLine{240     \}}
\DoxyCodeLine{241 }
\DoxyCodeLine{242     std::vector<double> bins = GetBinVec();}
\DoxyCodeLine{243 }
\DoxyCodeLine{244     m\_selected\_mc\_truth = \mbox{\hyperlink{class_plot_utils_1_1_hist_wrapper_map}{HM}}(Form(\textcolor{stringliteral}{"{}\%s"{}}, GetName().c\_str()), (GetName()+\textcolor{stringliteral}{"{};"{}}+m\_xaxis\_label).c\_str(), GetNBins(), bins, univs, tags);}
\DoxyCodeLine{245     m\_selected\_mc\_truth.AppendName(\textcolor{stringliteral}{"{}selected\_truth"{}},tags);}
\DoxyCodeLine{246   \}}
\DoxyCodeLine{247 }
\DoxyCodeLine{248   \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{249   \textcolor{keywordtype}{void} InitializeTruthHistograms(T univs, \textcolor{keyword}{const} std::vector< std::string> tags) \{}
\DoxyCodeLine{250     \textcolor{keywordflow}{if} (std::count(m\_for.begin(), m\_for.end(),\textcolor{stringliteral}{"{}truth"{}})< 1) \{}
\DoxyCodeLine{251       std::cout << \textcolor{stringliteral}{"{}VariableFromConfig Warning: truth is disabled for this variable "{}} << GetName() << std::endl;}
\DoxyCodeLine{252       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} tag:tags)\{}
\DoxyCodeLine{253         hasTruth[tag] = \textcolor{keyword}{false};}
\DoxyCodeLine{254       \}}
\DoxyCodeLine{255       \textcolor{keywordflow}{return};}
\DoxyCodeLine{256     \}}
\DoxyCodeLine{257     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \textcolor{keyword}{const} tag:tags)\{}
\DoxyCodeLine{258       hasTruth[tag] = \textcolor{keyword}{true};}
\DoxyCodeLine{259     \}}
\DoxyCodeLine{260 }
\DoxyCodeLine{261     \textcolor{keywordflow}{if}(m\_tunedmc==1)\{}
\DoxyCodeLine{262       std::cout << \textcolor{stringliteral}{"{}VariableFromConfig Warning: untuned MC disabled for this variable, only filling tuned MC "{}} << GetName() << std::endl;}
\DoxyCodeLine{263       \textcolor{keywordflow}{return};}
\DoxyCodeLine{264     \}}
\DoxyCodeLine{265 }
\DoxyCodeLine{266     std::vector<double> bins = GetBinVec();}
\DoxyCodeLine{267 }
\DoxyCodeLine{268     m\_signal\_mc\_truth = \mbox{\hyperlink{class_plot_utils_1_1_hist_wrapper_map}{HM}}(Form(\textcolor{stringliteral}{"{}\%s"{}}, GetName().c\_str()), (GetName()+\textcolor{stringliteral}{"{};"{}}+m\_xaxis\_label).c\_str(), GetNBins(), bins, univs, tags);}
\DoxyCodeLine{269     m\_signal\_mc\_truth.AppendName(\textcolor{stringliteral}{"{}all\_truth"{}},tags);}
\DoxyCodeLine{270   \}}
\DoxyCodeLine{271 }
\DoxyCodeLine{272   \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{273   \textcolor{keywordtype}{void} InitializeDataHistograms(T univs, \textcolor{keyword}{const} std::vector< std::string> tags) \{}
\DoxyCodeLine{274     \textcolor{keywordflow}{if} (std::count(m\_for.begin(), m\_for.end(),\textcolor{stringliteral}{"{}data"{}})< 1)  \{}
\DoxyCodeLine{275       std::cout << \textcolor{stringliteral}{"{}VariableFromConfig Warning: data is disabled for this variable "{}} << GetName() << std::endl;}
\DoxyCodeLine{276       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} tag:tags)\{}
\DoxyCodeLine{277         hasData[tag] = \textcolor{keyword}{false};}
\DoxyCodeLine{278       \}}
\DoxyCodeLine{279       \textcolor{keywordflow}{return};}
\DoxyCodeLine{280     \}}
\DoxyCodeLine{281     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} tag:tags)\{}
\DoxyCodeLine{282       hasData[tag] = \textcolor{keyword}{true};}
\DoxyCodeLine{283     \}}
\DoxyCodeLine{284     std::vector<double> recobins = GetRecoBinVec();}
\DoxyCodeLine{285 }
\DoxyCodeLine{286     m\_selected\_data = \mbox{\hyperlink{class_plot_utils_1_1_hist_wrapper_map}{HM}}(Form(\textcolor{stringliteral}{"{}\%s"{}}, GetName().c\_str()), (GetName()+\textcolor{stringliteral}{"{};"{}}+m\_xaxis\_label).c\_str(), GetNRecoBins(), recobins, univs,tags);}
\DoxyCodeLine{287     m\_selected\_data.AppendName(\textcolor{stringliteral}{"{}reconstructed"{}},tags);}
\DoxyCodeLine{288   \}}
\DoxyCodeLine{289 }
\DoxyCodeLine{290   \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{291   \textcolor{keywordtype}{void} InitializeTunedMCHistograms(T reco\_univs, T truth\_univs, \textcolor{keyword}{const} std::vector< std::string> tuned\_tags, \textcolor{keyword}{const} std::vector< std::string> response\_tags) \{}
\DoxyCodeLine{292     \textcolor{keywordflow}{if}(m\_tunedmc<1)\{}
\DoxyCodeLine{293       std::cout << \textcolor{stringliteral}{"{}VariableFromConfig Warning: tunedmc is disabled for this variable "{}} << GetName() << std::endl;}
\DoxyCodeLine{294       \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} tag:tuned\_tags)\{}
\DoxyCodeLine{295         hasTunedMC[tag] = \textcolor{keyword}{false};}
\DoxyCodeLine{296       \}}
\DoxyCodeLine{297       \textcolor{keywordflow}{return};}
\DoxyCodeLine{298     \}}
\DoxyCodeLine{299 }
\DoxyCodeLine{300     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} tag:tuned\_tags)\{}
\DoxyCodeLine{301       hasTunedMC[tag] = \textcolor{keyword}{true};}
\DoxyCodeLine{302     \}}
\DoxyCodeLine{303 }
\DoxyCodeLine{304     std::vector<double> bins = GetBinVec();}
\DoxyCodeLine{305     std::vector<double> recobins = GetRecoBinVec();}
\DoxyCodeLine{306 }
\DoxyCodeLine{307     \textcolor{comment}{// Check which categories are configured and add a tuned version}}
\DoxyCodeLine{308     \textcolor{keywordflow}{if} (std::count(m\_for.begin(), m\_for.end(),\textcolor{stringliteral}{"{}selected\_reco"{}})>=1)\{ \textcolor{comment}{// need special constructor to deal with reco bins}}
\DoxyCodeLine{309       m\_tuned\_mc\_reco = \mbox{\hyperlink{class_plot_utils_1_1_hist_wrapper_map}{HM}}(Form(\textcolor{stringliteral}{"{}\%s"{}}, GetName().c\_str()), (GetName()+\textcolor{stringliteral}{"{};"{}}+m\_xaxis\_label).c\_str(),GetNBins(),bins, GetNRecoBins(), recobins, reco\_univs, tuned\_tags);}
\DoxyCodeLine{310       m\_tuned\_mc\_reco.AppendName(\textcolor{stringliteral}{"{}reconstructed\_tuned"{}},tuned\_tags);}
\DoxyCodeLine{311     \}}
\DoxyCodeLine{312     \textcolor{keywordflow}{if} (std::count(m\_for.begin(), m\_for.end(),\textcolor{stringliteral}{"{}selected\_truth"{}})>=1) \{}
\DoxyCodeLine{313       m\_tuned\_selected\_mc\_truth = \mbox{\hyperlink{class_plot_utils_1_1_hist_wrapper_map}{HM}}(Form(\textcolor{stringliteral}{"{}\%s"{}}, GetName().c\_str()), (GetName()+\textcolor{stringliteral}{"{};"{}}+m\_xaxis\_label).c\_str(), GetNBins(), bins, reco\_univs, tuned\_tags);}
\DoxyCodeLine{314       m\_tuned\_selected\_mc\_truth.AppendName(\textcolor{stringliteral}{"{}selected\_truth\_tuned"{}},tuned\_tags);}
\DoxyCodeLine{315     \}}
\DoxyCodeLine{316     \textcolor{keywordflow}{if} (std::count(m\_for.begin(), m\_for.end(),\textcolor{stringliteral}{"{}truth"{}})>=1) \{}
\DoxyCodeLine{317       m\_tuned\_signal\_mc\_truth = \mbox{\hyperlink{class_plot_utils_1_1_hist_wrapper_map}{HM}}(Form(\textcolor{stringliteral}{"{}\%s"{}}, GetName().c\_str()), (GetName()+\textcolor{stringliteral}{"{};"{}}+m\_xaxis\_label).c\_str(), GetNBins(), bins, truth\_univs, tuned\_tags);}
\DoxyCodeLine{318       m\_tuned\_signal\_mc\_truth.AppendName(\textcolor{stringliteral}{"{}all\_truth\_tuned"{}},tuned\_tags);}
\DoxyCodeLine{319     \}}
\DoxyCodeLine{320 }
\DoxyCodeLine{321     \textcolor{comment}{// Now do response}}
\DoxyCodeLine{322     \textcolor{keywordflow}{if} (std::count(m\_for.begin(), m\_for.end(),\textcolor{stringliteral}{"{}response"{}})< 1) \{}
\DoxyCodeLine{323       std::cout << \textcolor{stringliteral}{"{}VariableFromConfig Warning: response is disabled for this variable "{}} << GetName() << std::endl;}
\DoxyCodeLine{324       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} tag:response\_tags)\{}
\DoxyCodeLine{325         hasResponse[tag] = \textcolor{keyword}{false};}
\DoxyCodeLine{326       \}}
\DoxyCodeLine{327       \textcolor{keywordflow}{return};}
\DoxyCodeLine{328     \}}
\DoxyCodeLine{329     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} tag:response\_tags)\{}
\DoxyCodeLine{330       assert(hasMC[tag]);}
\DoxyCodeLine{331       assert(hasSelectedTruth[tag]);}
\DoxyCodeLine{332       hasResponse[tag] = \textcolor{keyword}{true};}
\DoxyCodeLine{333     \}}
\DoxyCodeLine{334 }
\DoxyCodeLine{335     m\_tuned\_mc\_reco.AddResponse(response\_tags,\textcolor{stringliteral}{"{}\_tuned"{}});}
\DoxyCodeLine{336   \}}
\DoxyCodeLine{337 }
\DoxyCodeLine{338 }
\DoxyCodeLine{339   \textcolor{comment}{//========== Add Response =================}}
\DoxyCodeLine{340 }
\DoxyCodeLine{341   \textcolor{keywordtype}{void} AddMCResponse(\textcolor{keyword}{const} std::vector<std::string>  tags) \{}
\DoxyCodeLine{342     \textcolor{keywordflow}{if} (std::count(m\_for.begin(), m\_for.end(),\textcolor{stringliteral}{"{}response"{}})< 1) \{}
\DoxyCodeLine{343       std::cout << \textcolor{stringliteral}{"{}VariableFromConfig Warning: response is disabled for this variable "{}} << GetName() << std::endl;}
\DoxyCodeLine{344       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} tag:tags)\{}
\DoxyCodeLine{345         hasResponse[tag] = \textcolor{keyword}{false};}
\DoxyCodeLine{346       \}}
\DoxyCodeLine{347       \textcolor{keywordflow}{return};}
\DoxyCodeLine{348     \}}
\DoxyCodeLine{349 }
\DoxyCodeLine{350     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} tag:tags)\{}
\DoxyCodeLine{351       assert(hasMC[tag]);}
\DoxyCodeLine{352       assert(hasSelectedTruth[tag]);}
\DoxyCodeLine{353       hasResponse[tag] = \textcolor{keyword}{true};}
\DoxyCodeLine{354     \}}
\DoxyCodeLine{355 }
\DoxyCodeLine{356     \textcolor{keywordflow}{if}(m\_tunedmc==1)\{}
\DoxyCodeLine{357       std::cout << \textcolor{stringliteral}{"{}VariableFromConfig Warning: untuned MC disabled. Disabling untuned response for this variable "{}} << GetName() << std::endl;}
\DoxyCodeLine{358       \textcolor{keywordflow}{return};}
\DoxyCodeLine{359     \}}
\DoxyCodeLine{360 }
\DoxyCodeLine{361     m\_selected\_mc\_reco.AddResponse(tags);}
\DoxyCodeLine{362   \}}
\DoxyCodeLine{363 }
\DoxyCodeLine{364 }
\DoxyCodeLine{365   \textcolor{comment}{//============================================================================}}
\DoxyCodeLine{366   \textcolor{comment}{// WRITE ALL HISTOGRAMS}}
\DoxyCodeLine{367   \textcolor{comment}{//============================================================================}}
\DoxyCodeLine{368   \textcolor{keywordtype}{void} WriteAllHistogramsToFile(TFile\& f)  \{}
\DoxyCodeLine{369     std::cout << \textcolor{stringliteral}{"{}should only be called once "{}} << std::endl;}
\DoxyCodeLine{370     f.cd();}
\DoxyCodeLine{371 }
\DoxyCodeLine{372     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} tag:m\_tags)\{}
\DoxyCodeLine{373       std::cout << \textcolor{stringliteral}{"{} write out flags "{}} << hasMC[tag] << hasSelectedTruth[tag] << hasTruth[tag] << hasData[tag] << hasTunedMC[tag] <<  std::endl;}
\DoxyCodeLine{374       \textcolor{keywordflow}{if}(hasMC[tag])\{}
\DoxyCodeLine{375         \textcolor{keywordflow}{if}(m\_tunedmc!=1)\{}
\DoxyCodeLine{376           m\_selected\_mc\_reco.Write(tag);}
\DoxyCodeLine{377           std::cout << \textcolor{stringliteral}{"{} write out mc histogram "{}} << m\_selected\_mc\_reco.GetHist(tag)-\/>GetName() << std::endl;}
\DoxyCodeLine{378         \}}
\DoxyCodeLine{379         \textcolor{keywordflow}{if}(hasTunedMC[tag])\{}
\DoxyCodeLine{380           m\_tuned\_mc\_reco.Write(tag);}
\DoxyCodeLine{381           std::cout << \textcolor{stringliteral}{"{} write out tuned mc histogram "{}} << m\_tuned\_mc\_reco.GetHist(tag)-\/>GetName() << std::endl;}
\DoxyCodeLine{382         \}}
\DoxyCodeLine{383       \}}
\DoxyCodeLine{384       \textcolor{keywordflow}{if}(hasSelectedTruth[tag])\{}
\DoxyCodeLine{385         \textcolor{keywordflow}{if}(m\_tunedmc!=1)\{}
\DoxyCodeLine{386           std::cout << \textcolor{stringliteral}{"{} write out selected truth histogram "{}} << m\_selected\_mc\_truth.GetHist(tag)-\/>GetName() << std::endl;}
\DoxyCodeLine{387           m\_selected\_mc\_truth.Write(tag);}
\DoxyCodeLine{388         \}}
\DoxyCodeLine{389         \textcolor{keywordflow}{if}(hasTunedMC[tag])\{}
\DoxyCodeLine{390           m\_tuned\_selected\_mc\_truth.Write(tag);}
\DoxyCodeLine{391           std::cout << \textcolor{stringliteral}{"{} write out tuned mc histogram "{}} << m\_tuned\_selected\_mc\_truth.GetHist(tag)-\/>GetName() << std::endl;}
\DoxyCodeLine{392         \}}
\DoxyCodeLine{393       \}}
\DoxyCodeLine{394       \textcolor{keywordflow}{if}(hasTruth[tag])\{}
\DoxyCodeLine{395         \textcolor{keywordflow}{if}(m\_tunedmc!=1)\{}
\DoxyCodeLine{396           std::cout << \textcolor{stringliteral}{"{} write out truth histogram "{}} << m\_signal\_mc\_truth.GetHist(tag)-\/>GetName() << std::endl;}
\DoxyCodeLine{397           m\_signal\_mc\_truth.Write(tag);}
\DoxyCodeLine{398         \}}
\DoxyCodeLine{399         \textcolor{keywordflow}{if}(hasTunedMC[tag])\{}
\DoxyCodeLine{400           m\_tuned\_signal\_mc\_truth.Write(tag);}
\DoxyCodeLine{401           std::cout << \textcolor{stringliteral}{"{} write out tuned mc histogram "{}} << m\_tuned\_signal\_mc\_truth.GetHist(tag)-\/>GetName() << std::endl;}
\DoxyCodeLine{402         \}}
\DoxyCodeLine{403       \}}
\DoxyCodeLine{404       \textcolor{keywordflow}{if}(hasData[tag])\{}
\DoxyCodeLine{405         std::cout << \textcolor{stringliteral}{"{} write out data histogram "{}} << m\_selected\_data.GetHist(tag)-\/>GetName() << std::endl;}
\DoxyCodeLine{406         m\_selected\_data.Write(tag);}
\DoxyCodeLine{407       \}}
\DoxyCodeLine{408     \}}
\DoxyCodeLine{409   \}}
\DoxyCodeLine{410 }
\DoxyCodeLine{411   \textcolor{comment}{//============================================================================}}
\DoxyCodeLine{412   \textcolor{comment}{// SYNC ALL HISTOGRAMS}}
\DoxyCodeLine{413   \textcolor{comment}{//============================================================================}}
\DoxyCodeLine{414   \textcolor{keywordtype}{void} SyncAllHists() \{}
\DoxyCodeLine{415     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} tag:m\_tags)\{}
\DoxyCodeLine{416       \textcolor{keywordflow}{if}(hasMC[tag])\{}
\DoxyCodeLine{417         \textcolor{keywordflow}{if}(m\_tunedmc!=1)\{}
\DoxyCodeLine{418           m\_selected\_mc\_reco.SyncCVHistos();}
\DoxyCodeLine{419         \}}
\DoxyCodeLine{420         \textcolor{keywordflow}{if}(hasTunedMC[tag])\{}
\DoxyCodeLine{421           m\_tuned\_mc\_reco.SyncCVHistos();}
\DoxyCodeLine{422         \}}
\DoxyCodeLine{423       \}}
\DoxyCodeLine{424       \textcolor{keywordflow}{if}(hasSelectedTruth[tag])\{}
\DoxyCodeLine{425         \textcolor{keywordflow}{if}(m\_tunedmc!=1)\{}
\DoxyCodeLine{426           m\_selected\_mc\_truth.SyncCVHistos();}
\DoxyCodeLine{427         \}}
\DoxyCodeLine{428         \textcolor{keywordflow}{if}(hasTunedMC[tag])\{}
\DoxyCodeLine{429           m\_tuned\_selected\_mc\_truth.SyncCVHistos();}
\DoxyCodeLine{430         \}}
\DoxyCodeLine{431       \}}
\DoxyCodeLine{432       \textcolor{keywordflow}{if}(hasData[tag])\{}
\DoxyCodeLine{433         m\_selected\_data.SyncCVHistos();}
\DoxyCodeLine{434       \}}
\DoxyCodeLine{435       \textcolor{keywordflow}{if}(hasTruth[tag])\{}
\DoxyCodeLine{436         \textcolor{keywordflow}{if}(m\_tunedmc!=1)\{}
\DoxyCodeLine{437           m\_signal\_mc\_truth.SyncCVHistos();}
\DoxyCodeLine{438         \}}
\DoxyCodeLine{439         \textcolor{keywordflow}{if}(hasTunedMC[tag])\{}
\DoxyCodeLine{440           m\_tuned\_signal\_mc\_truth.SyncCVHistos();}
\DoxyCodeLine{441         \}}
\DoxyCodeLine{442       \}}
\DoxyCodeLine{443       \textcolor{comment}{// if(hasTunedMC[tag])\{}}
\DoxyCodeLine{444       \textcolor{comment}{//   m\_tuned\_mc\_reco.SyncCVHistos();}}
\DoxyCodeLine{445       \textcolor{comment}{//   m\_tuned\_selected\_mc\_truth.SyncCVHistos();}}
\DoxyCodeLine{446       \textcolor{comment}{//   m\_tuned\_signal\_mc\_truth.SyncCVHistos();}}
\DoxyCodeLine{447       \textcolor{comment}{// \}}}
\DoxyCodeLine{448     \}}
\DoxyCodeLine{449   \}}
\DoxyCodeLine{450 }
\DoxyCodeLine{451   \textcolor{keyword}{inline} \textcolor{keywordtype}{void} FillResponse(std::string tag, \mbox{\hyperlink{class_c_v_universe}{CVUniverse}}* univ, \textcolor{keyword}{const} \textcolor{keywordtype}{double} value, \textcolor{keyword}{const} \textcolor{keywordtype}{double} truth, \textcolor{keyword}{const} \textcolor{keywordtype}{double} weight, \textcolor{keyword}{const} \textcolor{keywordtype}{double} scale=1.0)\{}
\DoxyCodeLine{452     \textcolor{keywordflow}{if}(hasMC[tag] \&\& m\_tunedmc!=1)\{}
\DoxyCodeLine{453       m\_selected\_mc\_reco.FillResponse(tag, univ, value, truth, weight, 1.0);}
\DoxyCodeLine{454     \}}
\DoxyCodeLine{455     \textcolor{keywordflow}{if}(hasTunedMC[tag])\{}
\DoxyCodeLine{456       m\_tuned\_mc\_reco.FillResponse(tag, univ, value, truth, weight, scale);}
\DoxyCodeLine{457     \}}
\DoxyCodeLine{458   \}}
\DoxyCodeLine{459 }
\DoxyCodeLine{460   \textcolor{comment}{// helper to return the actual numeric index corresponding to a universe  ie, allows map from name,index space to pure universe space.}}
\DoxyCodeLine{461 }
\DoxyCodeLine{462   \textcolor{comment}{//  inline int UniverseIndex(CVUniverse* univ)\{}}
\DoxyCodeLine{463   \textcolor{comment}{//    return m\_map[univ];}}
\DoxyCodeLine{464   \textcolor{comment}{//  \}}}
\DoxyCodeLine{465   \textcolor{comment}{//}}
\DoxyCodeLine{466   \textcolor{comment}{//  //}}
\DoxyCodeLine{467 \};  \textcolor{comment}{//end of class}}
\DoxyCodeLine{468 }
\DoxyCodeLine{469 }
\DoxyCodeLine{470 }
\DoxyCodeLine{471 \}  \textcolor{comment}{// namespace Ben}}
\DoxyCodeLine{472 }
\DoxyCodeLine{473 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// VARIABLE\_H}}

\end{DoxyCode}
